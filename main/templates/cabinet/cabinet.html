{% extends "layout.html" %}
{% load static i18n %}

{% block title %} Личный кабинет {% endblock %}

{% block head %}
{% endblock %}


{% block body %}
<div class="container my-md-3 py-3 bg-white">
    <nav>
        <div class="nav nav-tabs" id="pills-tab" role="tablist">
            <a class="nav-item nav-link active" id="profile-tab" data-toggle="tab" href="#profile" role="tab"
                aria-controls="profile" aria-selected="true">Профиль</a>
            <a class="nav-item nav-link" id="files-tab" data-toggle="tab" href="#files" role="tab"
                aria-controls="files" aria-selected="false">Мои файлы</a>
        </div>
    </nav>
    <!-- Tab contents -->

    <div class="tab-content" id="nav-tabContent">

        <!-- Tab profile -->
        <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
            <h2 class="text-center mb-5 mt-2">Профиль "{% firstof user.first_name user.username user.email%}"</h2>

            <div class="stats" style="max-width:400px;">
                <div class="row">
                    <div class="col">Баланс</div>
                    <div class="col"><b>{{user.balance}} балл(ов)</b></div>
                </div>
                <div class="row">
                    <div class="col">Загружено работ</div>
                    <div class="col"><b>0</b></div>
                </div>
                <div class="row">
                    <div class="col">Скачано работ</div>
                    <div class="col"><b>0</b></div>
                </div>
            </div>

            <div class="btns mt-5">
                <a href="{% url 'users:logout'%}" class="btn btn-danger">Выйти из аккаунта</a>
                <a href="{% url 'users:change_password' %}" class="btn btn-warning" id="btn-changepass">Сменить пароль</a>
            </div>
        </div>

        <!-- Tab files -->

        <div class="tab-pane" id="files" role="tabpanel" aria-labelledby="files-tab">
            <h2 class="text-center mb-5 mt-2">Ваши файлы</h2>
            {% include 'blocks/documents_list.html'%}
        </div>
    </div>

    <script>
        document.querySelector('#pills-tab').style.visibility="none"
        window.addEventListener('load', ()=>{
            var pills = $('a[data-toggle="tab"]')

            pills.on('show.bs.tab', function (e) {
                location.hash = $(e.target).attr('href')
            });
            var activeTab = location.hash
            if (activeTab) {
                console.debug("Active tab:", activeTab)
                tab = $('#pills-tab a[href="' + activeTab + '"]')
                tab.tab('show');
            }
        })
    </script>
</div>
{% endblock %}